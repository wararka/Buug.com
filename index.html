<!DOCTYPE html>
<html lang="so">
<head>
<meta charset="UTF-8">
<title>üî• Pro Drag Editor + Text Styling</title>

<style>
    :root {
        --bg: #0f0f0f;
        --toolbar: rgba(30,30,30,0.9);
        --text: white;
        --block-bg: rgba(255,255,255,0.05);
        --border: #333;
        --accent: cyan;
    }

    body.light {
        --bg: #f5f5f5;
        --toolbar: rgba(255,255,255,0.9);
        --text: #111;
        --block-bg: rgba(0,0,0,0.05);
        --border: #ccc;
    }

    body {
        margin: 0;
        background: var(--bg);
        font-family: "Segoe UI", sans-serif;
        color: var(--text);
        overflow-x: hidden;
        transition: 0.3s;
    }

    /* Toolbar Style */
    #toolbar {
        background: var(--toolbar);
        backdrop-filter: blur(10px);
        padding: 10px;
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
        position: sticky;
        top: 0;
        z-index: 1000;
        border-bottom: 1px solid var(--border);
        align-items: center;
    }

    .tool-group {
        display: flex;
        gap: 5px;
        border-right: 1px solid var(--border);
        padding-right: 10px;
        margin-right: 5px;
    }

    button, select, input[type="color"] {
        background: #1f1f1f;
        color: white;
        border: 1px solid #444;
        padding: 6px 12px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 13px;
        transition: 0.2s;
    }

    body.light button, body.light select {
        background: #e0e0e0;
        color: #111;
        border: 1px solid #ccc;
    }

    button:hover {
        background: #333;
        color: var(--accent);
        border-color: var(--accent);
    }

    /* Editor */
    #editor {
        min-height: 100vh;
        padding: 30px;
        position: relative;
    }

    .block {
        position: absolute;
        padding: 10px;
        cursor: grab;
        border-radius: 8px;
    }

    .text-block {
        background: var(--block-bg);
        border-left: 3px solid var(--accent);
        min-width: 150px;
        max-width: 450px;
        outline: none;
    }

    .text-block:focus {
        border-color: #00ff00;
        box-shadow: 0 0 10px rgba(0,255,0,0.2);
    }

    img, video {
        max-width: 300px;
        border-radius: 10px;
        display: block;
    }

    /* Modals */
    #helpModal, #shareModal {
        position: fixed;
        top: 0; left: 0;
        width: 100%; height: 100%;
        background: rgba(0,0,0,0.8);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 2000;
    }

    .modal-box {
        background: #1f1f1f;
        padding: 25px;
        width: 350px;
        border-radius: 12px;
        text-align: center;
        color: white;
        border: 1px solid #444;
    }

    .share-btn {
        width: 100%;
        margin: 5px 0;
        padding: 10px;
        border-radius: 6px;
        background: #2a2a2a;
        color: white;
        border: none;
        cursor: pointer;
        text-align: left;
    }

    .share-btn:hover { background: #444; color: cyan; }
</style>
</head>
<body>

<div id="toolbar">
    <div class="tool-group">
        <button onclick="addText()">+ Qoraal</button>
        <button onclick="addImage()">+ Sawir</button>
    </div>

    <div class="tool-group">
        <button onclick="formatDoc('bold')" title="Buuri"><b>B</b></button>
        <button onclick="formatDoc('italic')" title="Qaloci"><i>I</i></button>
        <button onclick="formatDoc('underline')" title="Xariiq"><u>U</u></button>
        
        <select onchange="formatDoc('fontSize', this.value)" title="Cabbirka">
            <option value="3">Size: Dhexdhexaad</option>
            <option value="1">Aad u yar</option>
            <option value="2">Yar</option>
            <option value="4">Wayn</option>
            <option value="5">Aad u wayn</option>
            <option value="6">Cinwaan</option>
        </select>

        <input type="color" onchange="formatDoc('foreColor', this.value)" title="Midabka Qoraalka">
    </div>

    <div class="tool-group">
        <button onclick="leftAll()">‚¨Ö</button>
        <button onclick="centerAll()">‚Üï</button>
        <button onclick="rightAll()">‚û°</button>
    </div>

    <button onclick="toggleMode()">üåó Mode</button>
    <button onclick="openShare()" style="background: #2e7d32;">üì§ Share</button>
    <button onclick="openHelp()">‚ùî</button>
</div>

<div id="editor"></div>

<div id="helpModal">
    <div class="modal-box">
        <h2>üìò Tilmaame</h2>
        <p>1. Dooro qoraal aad qortay si aad u bedesho.</p>
        <p>2. Isticmaal badhamada B, I, U si aad u qurxiso.</p>
        <p>3. Jiid (Drag) meel kasta oo aad rabto.</p>
        <button onclick="closeHelp()" style="width:100%">Waan fahmay</button>
    </div>
</div>

<div id="shareModal">
    <div class="modal-box">
        <h2>üì§ Wadaag</h2>
        <button class="share-btn" onclick="shareWhatsApp()">WhatsApp</button>
        <button class="share-btn" onclick="shareTelegram()">Telegram</button>
        <button class="share-btn" onclick="downloadText()">Save as .txt</button>
        <button onclick="closeShare()" style="width:100%; margin-top:10px;">Xir</button>
    </div>
</div>

<script>
let editor = document.getElementById("editor");

/* TEXT FORMATTING FUNCTION */
function formatDoc(cmd, value = null) {
    // Tani waxay wax ka bedeshaa qoraalka aad dooratay (highlighted)
    document.execCommand(cmd, false, value);
}

/* DARK / LIGHT MODE */
function toggleMode() { document.body.classList.toggle("light"); }
function openHelp() { document.getElementById("helpModal").style.display = "flex"; }
function closeHelp() { document.getElementById("helpModal").style.display = "none"; }
function openShare() { document.getElementById("shareModal").style.display = "flex"; }
function closeShare() { document.getElementById("shareModal").style.display = "none"; }

/* DRAG SYSTEM */
function makeDraggable(el) {
    let offsetX, offsetY;
    el.addEventListener("mousedown", (e) => {
        if (document.activeElement === el) return; // Ha dhaqaajin haddii la qorayo
        let p = e;
        offsetX = p.clientX - el.offsetLeft;
        offsetY = p.clientY - el.offsetTop;
        document.onmousemove = (ev) => {
            el.style.left = (ev.clientX - offsetX) + "px";
            el.style.top = (ev.clientY - offsetY) + "px";
        };
        document.onmouseup = () => { document.onmousemove = null; };
    });
}

/* ADD TEXT BLOCK */
function addText() {
    let div = document.createElement("div");
    div.className = "block text-block";
    div.contentEditable = true;
    div.innerHTML = "Qoraal cusub...";
    div.style.left = "100px";
    div.style.top = "100px";

    editor.appendChild(div);
    makeDraggable(div);
    div.focus();
}

/* ADD IMAGE */
function addImage() {
    let input = document.createElement("input");
    input.type = "file";
    input.accept = "image/*";
    input.onchange = () => {
        let reader = new FileReader();
        reader.onload = () => {
            let img = document.createElement("img");
            img.src = reader.result;
            let block = document.createElement("div");
            block.className = "block";
            block.style.left = "50px"; block.style.top = "50px";
            block.appendChild(img);
            editor.appendChild(block);
            makeDraggable(block);
        };
        reader.readAsDataURL(input.files[0]);
    };
    input.click();
}

/* ALIGNMENT FUNCTIONS */
function leftAll() { document.querySelectorAll(".block").forEach(b => b.style.left = "20px"); }
function centerAll() { 
    let screen = window.innerWidth;
    document.querySelectorAll(".block").forEach(b => b.style.left = (screen/2 - b.offsetWidth/2) + "px"); 
}
function rightAll() { 
    let screen = window.innerWidth;
    document.querySelectorAll(".block").forEach(b => b.style.left = (screen - b.offsetWidth - 40) + "px"); 
}

/* SHARE & DOWNLOAD */
function shareWhatsApp() { window.open("https://wa.me/?text=" + encodeURIComponent(editor.innerText)); }
function shareTelegram() { window.open("https://t.me/share/url?text=" + encodeURIComponent(editor.innerText)); }
function downloadText() {
    let blob = new Blob([editor.innerText], { type: "text/plain" });
    let link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = "my_note.txt";
    link.click();
}
</script>

</body>
</html>
